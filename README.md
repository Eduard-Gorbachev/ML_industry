# ML_industry

## Описание проекта: промышленность

Для оптимизации производственных расходов, металлургический комбинат «Стальная птица» решил уменьшить потребление электроэнергии на этапе обработки стали. Для этого комбинату нужно контролировать температуру сплава.
Хорошей партией считается партия, имеющая две и более замеров температур. Некачественные партии (с одним замером температуры) использовать не нужно.

Задача — построить модель, которая будет предсказывать последнюю температуру сплава партии. Заказчик хочет использовать разработанную модель для имитации технологического процесса.


#### В работе используются следующие модели:

- LinearRegression — линейная регрессия
- LightGBM — градиентный бустинг для задач регрессии

  
## Цель исследования:

- Построить модель машинного обучения, которая будет предсказывать последнюю температуру сплава партии: решаем задачу регрессии;
- Метрика `МАЕ` лучшей модели на тестовых данных не более 6.8

## Как запустить проект

- Открыть файл `ML_industry.ipynb` в GitHub
  
или
- Скачайте и запустите файл `ML_industry.ipynb` или ноутбук с аналогичным кодом в Jupyter. Данные находятся в в папке `data_files`. При чтении файла укажите свой путь к файлу в коде. 


## Краткие результаты

С помощью `GridSearchCV` перебрали для модели линейной регрессии `LinearRegression` методы масштабирования признаков StandardScaler, MinMaxScaler, passthrough. Наилучшим образом справилась модель LinearRegression() без масштабирования прзнаков passthrough. Метрика `MAE` на кросс-валидации составила 6.35.

С помощью `OptunaSearchCV` подобрали для модели градиентного бустинга `LGBMRegressor` гиперпараметры максимальной глубины дерева, количество деревьев и скорости обучения. Мы получили модель LGBMRegressor со следующими гиперпараметрами: `'max_depth': 46, 'n_estimators': 205, 'learning_rate': 0.020850523701962827`. Метрика `MAE` на кросс-валидации модели составила 6.11.

Метрика `MAE` модели `LGBMRegressor` на тестовой выборке составила 6.5, для заказчика значение метрики MAE на тестовой выборке должно быть не больше 6.8. Модель прошла проверку на адекватность: MAE константной модели на тестовой выборке выше на 1.5 чем у нашей лучшей модели.

Наиболее важными для модели LGBMRegressor являются следующие признаки (в порядке убывания важности):

- `sum_time_heat` — суммарное время нагрева для каждой партии;
- `temperature` — показатель первой температуры сплава партии;
- `gas_1` — объём подаваемого газа для каждой партии;
- `wire_1` — объем подаваемого проволочного материала для каждой партии;
- `bulk_14` — объем подаваемого сыпучего метериала для каждой партии;
